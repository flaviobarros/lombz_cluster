{
    "contents" : "## Carregando o conjunto de dados\nshopping <- read.csv('shopping.csv')\nshopping <- shopping[,-1]\n\n## Análise descritiva\nsummary(shopping)\n\n## Obtendo a média por variável\napply(shopping, 2, mean)\n\n## Mudando a escala\npmatrix <- scale(shopping)\npcenter <- attr(pmatrix, \"scaled:center\")\npscale <- attr(pmatrix, \"scaled:scale\")\n\n## Criando o cluster\nd <- dist(pmatrix, method=\"euclidean\")\npfit <- hclust(d, method=\"ward\")\nplot(pfit)\n\n## Desenhando a separação dos clusters\nrect.hclust(pfit, k=3)\n\n## K-means pelo método do cotovelo\n## da proteína\nmydata <- pmatrix\nwss <- (nrow(mydata)-1)*sum(apply(mydata,2,var))\nfor (i in 2:15) wss[i] <- sum(kmeans(mydata,\n                                     centers=i)$withinss)\nplot(1:15, wss, type=\"b\", xlab=\"Number of Clusters\",\n     ylab=\"Within groups sum of squares\")\nabline(v=3)\n\n## Pegando os cluster do kmeans\nclusters <- kmeans(pmatrix, centers = 3)\n\n## Juntando a informação do cluster\nshopping$grupos <- factor(clusters$cluster)\n\n## Perfil das variáveis por grupo\nshopping_segments <- split(shopping[,-9], shopping$grupos)\nsapply(shopping_segments, function(x) apply(x, 2, mean))\n",
    "created" : 1455921183552.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1680352690",
    "id" : "B6CD4F71",
    "lastKnownWriteTime" : 1455927084,
    "path" : "~/Gitprojects/Lombaz/Cluster/shopping_analysis.R",
    "project_path" : "shopping_analysis.R",
    "properties" : {
        "notebook_format" : "pdf_document",
        "tempName" : "Untitled1"
    },
    "relative_order" : 6,
    "source_on_save" : false,
    "type" : "r_source"
}