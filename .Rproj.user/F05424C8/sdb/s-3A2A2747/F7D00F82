{
    "contents" : "## Carregando os pacotes necessários\nlibrary(readr)\n\n## Lendo o conjunto de dados\nprotein <- read.table('protein.txt', header = T, sep = '\\t')\n\n## Sumário básico\nsummary(protein)\n\n## Mudando a escala\npmatrix <- scale(protein[,-1])\npcenter <- attr(pmatrix, \"scaled:center\")\npscale <- attr(pmatrix, \"scaled:scale\")\n\n## Criando o cluster\nd <- dist(pmatrix, method=\"euclidean\")\npfit <- hclust(d, method=\"ward\")\nplot(pfit)\n\n## Desenhando a separação dos clusters\nrect.hclust(pfit, k=5)\n\n## Obtendo os grupos para cada cluster\ngroups <- cutree(pfit, k=5)\n\n## Função para imprimir os cluster\nprint_clusters <- function(labels, k) {\n  for(i in 1:k) {\n    print(paste(\"cluster\", i))\n    print(protein[labels==i,c(\"Country\",\"RedMeat\",\"Fish\",\"Fr.Veg\")])\n  }\n}\n\n## Imprimindo os cluster\nprint_clusters(groups, 5)\n\n## Visualizando os clusters\nlibrary(ggplot2)\nprinc <- prcomp(pmatrix)\nnComp <- 2\nproject <- predict(princ, newdata = pmatrix)[,1:nComp]\n\n## Criando uma tabela com os dados transformados\nproject.plus <- cbind(as.data.frame(project),\n                      cluster=as.factor(groups),\n                      country=protein$Country)\n\n## Fazendo o gráfico\nlibrary(ggplot2)\nggplot(project.plus, aes(x=PC1, y=PC2)) +\n  geom_point(aes(shape=cluster)) +\n  geom_text(aes(label=country), hjust=0, vjust=1)\n  \n## Fazendo em 3D\n## Fazendo o plot em 3D\n## Projetando em 3 dimensões\nproject <- predict(princ, newdata = pmatrix)[,1:3]\nlibrary(rgl)\nplot3d(project, col=project.plus$cluster, pch = 19)\n\n## Hack para fazer em 3D algo similar ao que foi feito\nplot3d(project, col=project.plus$cluster, pch = 19)\ntext3d(project,texts=project.plus$country)\n\n###################### K-MEANS #####################################\n## Gerando um conjunto de dados fictício\nn = 100\ng = 6 \nset.seed(g)\nd <- data.frame(x = unlist(lapply(1:g, function(i) rnorm(n/g, runif(1)*i^2))), \n                y = unlist(lapply(1:g, function(i) rnorm(n/g, runif(1)*i^2))))\nplot(d)\n\n## Método do cotovelo\nmydata <- d\nwss <- (nrow(mydata)-1)*sum(apply(mydata,2,var))\nfor (i in 2:15) wss[i] <- sum(kmeans(mydata,\n                                     centers=i)$withinss)\nplot(1:15, wss, type=\"b\", xlab=\"Number of Clusters\",\n     ylab=\"Within groups sum of squares\")\n\n## Aplicando o k-means e o método do cotovelo para os dados\n## da proteína\nmydata <- pmatrix\nwss <- (nrow(mydata)-1)*sum(apply(mydata,2,var))\nfor (i in 2:15) wss[i] <- sum(kmeans(mydata,\n                                     centers=i)$withinss)\nplot(1:15, wss, type=\"b\", xlab=\"Number of Clusters\",\n     ylab=\"Within groups sum of squares\")\n",
    "created" : 1455909191436.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3004265879",
    "id" : "F7D00F82",
    "lastKnownWriteTime" : 1455926987,
    "path" : "~/Gitprojects/Lombaz/Cluster/protein_analisys.R",
    "project_path" : "protein_analisys.R",
    "properties" : {
        "notebook_format" : "pdf_document",
        "tempName" : "Untitled1"
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "type" : "r_source"
}